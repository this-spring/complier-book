<!--
 * @Author: xiuquanxu
 * @Company: kaochong
 * @Date: 2020-01-30 11:26:57
 * @LastEditors: xiuquanxu
 * @LastEditTime: 2020-02-19 01:06:45
 -->
# 第三章 词法分析  

词法分析的任务是：从左向右逐个字符扫描，产生一个一个单词符号，把字符串源程序改造成单词符号串的中间程序。因此，词法分析是编译的基础。  

执行词法分析的程序称为**词法分析器**。

## 3.1 词法分析器的要求  

本节首先研究词法分析器输出的一般形式，其次研究词法分析器和语法分析器进行衔接。  

### 3.1.1 词法分析器的功能和输出形式  
词法分析功能室输入**源程序字符串**输出**单词符号**。单词符号一般分为如下几种：
* 关键字: if、else、for、while....
* 标识符: 变量名、数组名、函数名....
* 常数: 整型、实型、布尔型、文字型....
* 运算符: +、-、*.....
* 界符: ,、;、()、``、/*、*/....  

一个语言中关键字、运算符、界符个数都是确定的。  
词法分析器所输出的单词符号尝尝表示成如下的二元式：  
```
(单词种别，单词符号的属性值)
```  
**单词种别**通常使用整数编码。具体如何分不同的编译器设计时候不一样。例如我们可以将关键字全体视为一种，也可以将关键字一字一种。我们也可以将常数按照类型划分，整型一种、布尔型一种，也可以将整体化为一种。整体划分好处是分类清晰，每个一种的好处是处理方便。这个具体单词种别要看编译器的设计。  

如果一个种别只含有一个单词符号，那么种别编码就代表它自身。若一个种别含有多个单词符号，那么对于它的每个单词符号，除了给出种别编码之外，还应给出有关**单词符号的属性信息**。  

单词符号属性指的是能代表该符号的特性(值),例如标识符的单词符号属性就是执行该表示符的指针。  

在本书中，我们假定关键字、运算符和界符都是一符一种。对于他们，词法分析给出其种别编码，不给出它自身的值。标识符统一为一种。常数按类型分类。  

下面给出一个词法分析后的例子:  
```
while (i >= j) i --;
```  

经词法分析处理后，它将转换为单词符号序列：  
```
<!-- while关键字，一字一符，不给出单词符号属性值 -->
<while, ->
<!-- (界符，一字一符，不给出单词符号属性值 -->
<(, ->
<!-- i标识符，统一一个类别，给出单词符号属性值，为指向它的指针 -->
<id, 指向i的符号的指针>
<!-- >=常数一字一符，不给出单词符号属性 -->
<>=, ->
<id, 指向j的符号的指针>
<), ->
<id, 执行i的符号指针>
<--, ->
```  

### 3.1.2 词法分析器作为一个独立子程序  

词法分析是否需要安排单独一遍呢？这个没有确切的答案，我们可以安排进行单独进行一遍解析出所有的单词符号，然后交给语法解析。但是这样需要把解析出的符号全部保存，保存了一个程序的内码形式，这似乎没有必要。更加理想的做法是**我们可以将词法分析器安排成一个子程序，当语法分析器需要一个单词符号时候，词法分析器子程序再从输入读进一短字符串处理成一个单词符号交给语法解析器，这样词法解析器安排成一个子程序比较自然，后面讨论中我们就假设词法解析器就是这样工作的**。  

实际上具体词法解析器需不需要单独一遍，没有确定答案，就要看编译器怎么实现。比较常用的做法就是上面提到的作为一个单独的子程序。  

## 3.2 词法分析器的设计